<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Chigga Land</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="app">
      <!-- Full Screen Game -->
      <canvas id="gameCanvas"></canvas>

      <!-- Top Left: Profile & Stats -->
      <div class="hud-panel" id="stats-bar">
        <div class="logo">üè∞ Chigga Land</div>
        <div id="turn-indicator" class="badge">Waiting for P1...</div>
        <div id="vp-badge">üèÜ 0 VP</div>
        <button
          id="resetGameBtn"
          class="btn-sec"
          style="font-size: 12px; padding: 5px 10px"
        >
          üîÑ Reset
        </button>
      </div>

      <!-- Top Right: Dynamic Player List -->
      <div class="hud-panel" id="player-list">
        <!-- Filled by JS: Avatar | Name | Cards | Army -->
      </div>

      <!-- Dice Display (Under Player List) -->
      <div
        class="hud-panel"
        id="dice-display"
        style="
          position: absolute;
          top: 300px;
          right: 20px;
          text-align: center;
          min-width: 100px;
        "
      >
        <div style="font-size: 12px; color: #aaa">Last Roll</div>
        <div
          id="last-roll-value"
          style="font-size: 24px; font-weight: bold; color: white"
        >
          -
        </div>
      </div>

      <!-- Right Side: Active Trades -->
      <div id="trade-sidebar" class="hud-panel">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #555;
            margin-bottom: 5px;
            padding-bottom: 5px;
          "
        >
          <h3 style="margin: 0; border: none; padding: 0">Active Trades</h3>
          <span id="closeTradeSidebar" style="cursor: pointer; font-size: 20px"
            >&times;</span
          >
        </div>
        <div id="trade-feed"></div>
      </div>

      <!-- Bottom Left: Activity Feed (Discord Style) -->
      <div class="hud-panel" id="chat-panel">
        <div id="game-log">
          <div id="chat-messages"></div>
        </div>
        <div class="chat-input-wrapper">
          <input
            type="text"
            id="chatInput"
            placeholder="Say something..."
            maxlength="200"
          />
          <button id="sendChatBtn">‚û§</button>
        </div>
      </div>

      <!-- Bottom Right: Music Player -->
      <div
        class="hud-panel"
        id="music-player"
        style="
          position: absolute;
          bottom: 20px;
          right: 20px;
          width: 250px;
          padding: 10px;
          display: flex;
          flex-direction: column;
          gap: 5px;
        "
      >
        <div
          style="
            font-weight: bold;
            border-bottom: 1px solid #555;
            padding-bottom: 5px;
            margin-bottom: 5px;
          "
        >
          üéµ DJ Booth
        </div>
        <div
          id="player-status"
          style="
            font-size: 12px;
            color: #aaa;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
          "
        >
          No music playing
        </div>

        <!-- Hidden YouTube Player -->
        <div
          id="yt-player-container"
          style="position: absolute; top: -9999px; left: -9999px"
        ></div>

        <div style="display: flex; gap: 5px">
          <input
            type="text"
            id="musicInput"
            placeholder="YouTube URL"
            style="flex-grow: 1; font-size: 12px; padding: 4px"
          />
          <button id="playMusicBtn" style="font-size: 12px; padding: 4px 8px">
            ‚ñ∂Ô∏è
          </button>
        </div>

        <div
          style="
            display: flex;
            gap: 5px;
            justify-content: space-between;
            align-items: center;
          "
        >
          <div>
            <button
              id="pauseMusicBtn"
              style="font-size: 12px; padding: 4px 8px"
            >
              ‚è∏Ô∏è
            </button>
            <button id="skipMusicBtn" style="font-size: 12px; padding: 4px 8px">
              ‚è≠Ô∏è
            </button>
          </div>
          <div style="display: flex; align-items: center; gap: 2px">
            <span style="font-size: 10px">üîä</span>
            <input
              type="range"
              id="volumeSlider"
              min="0"
              max="100"
              value="50"
              style="width: 60px"
            />
          </div>
        </div>
      </div>

      <!-- Bottom Center: Hand & Action Bar -->
      <div id="action-dock">
        <div id="hand-container"><!-- JS injects card divs here --></div>
        <div class="separator"></div>
        <div id="controls">
          <button id="rollDiceBtn" class="btn-main">üé≤ Roll</button>
          <button id="tradeBtn" class="btn-sec">ü§ù Trade</button>
          <button id="buildRoadBtn" class="btn-sec" title="Road">üõ£Ô∏è</button>
          <button id="buildSettlementBtn" class="btn-sec" title="Settlement">
            üè†
          </button>
          <button id="buildCityBtn" class="btn-sec" title="City">üè∞</button>
          <button id="buyDevCardBtn" class="btn-sec" title="Dev Card">
            üÉè
          </button>
          <button id="endTurnBtn" class="btn-danger">üõë End</button>
        </div>
      </div>

      <!-- Floating Trade Offer (Hidden by default) -->
      <div id="activeOffers" class="toast-container">
        <!-- JS injects offers here -->
      </div>
    </div>

    <!-- Modals (Keep existing functionality) -->
    <div id="joinModal" class="modal">
      <div class="modal-content">
        <h1>Welcome to Chigga Land</h1>
        <input type="text" id="nicknameInput" placeholder="Enter your name" />
        <br />
        <button id="joinGameBtn" class="primary">Join Game</button>
      </div>
    </div>

    <div id="discardModal" class="modal hidden">
      <div class="modal-content">
        <h2>The Gypsy!</h2>
        <p>
          You have more than 7 cards. Discard
          <span id="discardCount">0</span> cards.
        </p>
        <div
          id="discard-controls"
          style="
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
          "
        >
          <!-- JS injects controls -->
        </div>
        <button id="confirmDiscardBtn" class="primary">Discard</button>
      </div>
    </div>

    <div id="tradeModal" class="modal hidden">
      <div class="modal-content">
        <h2>Trading</h2>
        <div
          style="
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
          "
        >
          <div>
            <h3>Offer</h3>
            <select id="offerRes">
              <option>wood</option>
              <option>brick</option>
              <option>sheep</option>
              <option>wheat</option>
              <option>ore</option>
            </select>
            <input
              type="number"
              id="offerAmt"
              value="1"
              min="1"
              style="width: 50px"
            />
          </div>
          <div>
            <h3>Request</h3>
            <select id="reqRes">
              <option>wood</option>
              <option>brick</option>
              <option>sheep</option>
              <option>wheat</option>
              <option>ore</option>
            </select>
            <input
              type="number"
              id="reqAmt"
              value="1"
              min="1"
              style="width: 50px"
            />
          </div>
        </div>
        <button id="postTradeBtn" class="primary">Post Offer</button>
        <button
          onclick="document.getElementById('tradeModal').classList.add('hidden')"
          style="margin-left: 10px"
        >
          Close
        </button>

        <hr style="margin: 20px 0; border-color: rgba(255, 255, 255, 0.1)" />

        <h3>Maritime Trade</h3>
        <div
          id="trade-rates"
          style="font-size: 12px; margin-bottom: 10px; color: #aaa"
        >
          Standard Rate: 4:1
        </div>
        <select id="bankGive">
          <option>wood</option>
          <option>brick</option>
          <option>sheep</option>
          <option>wheat</option>
          <option>ore</option>
        </select>
        <span>&rarr;</span>
        <select id="bankGet">
          <option>wood</option>
          <option>brick</option>
          <option>sheep</option>
          <option>wheat</option>
          <option>ore</option>
        </select>
        <button id="bankTradeBtn">Trade</button>
      </div>
    </div>

    <!-- Dice Container -->
    <div id="dice-container" class="hidden">
      <div id="dice1" class="dice">
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
      </div>
      <div id="dice2" class="dice">
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
        <div class="pip"></div>
      </div>
    </div>

    <!-- Dev Card Reveal Container -->
    <div id="dev-card-reveal" class="hidden">
      <div class="card-inner">
        <div class="card-front">
          <div class="card-logo">?</div>
          <div>Dev Card</div>
        </div>
        <div class="card-back">
          <div id="revealed-card-title">Knight</div>
          <div id="revealed-card-desc">Move the robber</div>
        </div>
      </div>
    </div>

    <!-- Start Game Button (Overlay) -->
    <div
      id="start-overlay"
      style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 100;
        pointer-events: none;
      "
    >
      <button
        id="startGameBtn"
        class="primary"
        style="
          pointer-events: auto;
          display: none;
          font-size: 24px;
          padding: 15px 30px;
        "
      >
        Start Game
      </button>
    </div>

    <script
      src="https://cdn.socket.io/4.7.5/socket.io.min.js"
      integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO"
      crossorigin="anonymous"
    ></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="shared.js"></script>
    <script src="client.js"></script>
  </body>
</html>
